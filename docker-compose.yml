version: '3.6'

services:

  server:
    build:
      context: .
      target: server
    volumes:
      - .:/CIMonitor
    user: ${USERID}:${GROUPID}
    command: sh -c "npm run server"
    ports:
      - "3030:3030"

  module-client:
    build:
      context: .
      target: server
    volumes:
      - .:/CIMonitor
    user: ${USERID}:${GROUPID}
    command: sh -c "npm run module-client"

  dashboard:
    build:
      context: .
      target: dashboard
    volumes:
      - .:/CIMonitor
    user: ${USERID}:${GROUPID}
    command: sh -c "npm run dashboard"
    ports:
      - "3031:3031"

networks:

  default:
    name: cimonitor
